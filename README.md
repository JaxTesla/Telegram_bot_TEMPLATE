# Шаблон Телеграм Бота на Python

## Описание

Этот проект представляет собой шаблон для создания Telegram ботов на Python с использованием библиотеки `telebot` (pyTelegramBotAPI). Шаблон включает в себя основные компоненты для разработки, такие как обработчики сообщений, логирование, мониторинг изменений в файлах с автоматическим перезапуском бота и многое другое. Он предназначен для быстрого старта разработки надежных и масштабируемых Telegram ботов.

## Основные возможности

- **Обработка команд и сообщений**: Поддержка различных типов сообщений (текст, фото, аудио, видео и другие) и команд (например, `/start`, `/help`).
- **Логирование**: Настроенный логгер с ротацией файлов, вывод логов как в файл, так и в консоль. Включает декораторы для логирования вызовов функций.
- **Мониторинг файлов**: Использование `watchdog` для отслеживания изменений в ключевых файлах проекта и автоматического перезапуска бота при внесении изменений.
- **Многопоточность**: Разделение задач бота и мониторинга на отдельные потоки для повышения стабильности и отзывчивости.
- **Управление событиями**: Возможность остановки и перезапуска бота через события, что облегчает управление жизненным циклом приложения.

## Структура проекта

```
├── bot.py                 # Определение обработчиков сообщений и команд
├── main.py                # Основной файл для запуска бота и мониторинга
├── logger.py              # Настройка логирования и декораторы
├── watchdog_monitoring.py # Настройка мониторинга файлов с использованием watchdog
├── settings
│   └── key.json           # Файл с токеном бота и другими настройками
├── requirements.txt       # Список зависимостей проекта
└── README.md              # Описание проекта
```

## Установка

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/ваш-логин/ваш-репозиторий.git
   cd ваш-репозиторий
   ```

2. **Создайте и активируйте виртуальное окружение (рекомендуется):**

   ```bash
   python -m venv venv
   source venv/bin/activate  # Для Linux/macOS
   venv\Scripts\activate     # Для Windows
   ```

3. **Установите зависимости:**

   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте файл с токеном:**

   Создайте файл `settings/key.json` и добавьте в него ваш токен бота:

   ```json
   {
       "tgm_bots": {
           "SendingTradeSignal_Bot": {
               "tgm_bot_token": "ВАШ_ТОКЕН_БОТА"
           }
       }
   }
   ```

## Использование

1. **Запуск бота:**

   ```bash
   python main.py
   ```

   При запуске бот начнет прослушивание команд и сообщений. Все логируемые события будут сохраняться в файл `bot_log.log` и отображаться в консоли.

2. **Добавление новых обработчиков:**

   В файле `bot.py` вы можете добавить новые обработчики сообщений или команд, используя декораторы `@signal_bot.message_handler` и другие.

3. **Мониторинг изменений:**

   Шаблон автоматически отслеживает изменения в файлах, указанных в `file_list` (например, `main.py`, `bot.py`, `logger.py`, `watchdog_monitoring.py`). При внесении изменений бот будет автоматически перезапущен для применения новых изменений.

## Логирование

Логирование настроено с использованием модуля `logging` и включает:

- **Файловый логгер**: С ротацией файлов при достижении 50 МБ, хранение до 5 резервных файлов.
- **Консольный логгер**: Вывод логов в консоль для удобства отладки.
- **Декораторы**: Декоратор `@log_function_call` для автоматического логирования вызовов функций с аргументами.

Логи сохраняются в директорию `f:\code\logs\TGM_Pattern\bot_log.log`. При необходимости путь можно изменить в файле `logger.py`.

## Мониторинг файлов с Watchdog

Используется библиотека `watchdog` для отслеживания изменений в файлах проекта. При обнаружении изменения в одном из файлов из списка `file_list` бот автоматически перезапустится.

## Внесение изменений

Если вы хотите добавить новые функции или изменить существующие, следуйте этим шагам:

1. **Добавьте новый обработчик в `bot.py`.**
2. **Обновите список файлов для мониторинга в `main.py`, если добавлены новые файлы.**
3. **Перезапустите бота или внесите изменения в код – бот автоматически перезапустится благодаря Watchdog.**

## Вклад

Если вы хотите внести вклад в развитие этого шаблона, создайте [Issue](https://github.com/ваш-логин/ваш-репозиторий/issues) или отправьте [Pull Request](https://github.com/ваш-логин/ваш-репозиторий/pulls).

## Лицензия

Этот проект лицензирован под [MIT License](LICENSE).

---

*Этот шаблон разработан для упрощения процесса создания Telegram ботов и может быть адаптирован под различные задачи и требования.*
